//check user loggedin
function checkAuth(req, res, next) {
    if (req.session.user) {
        next();
    } else {
        res.redirect('/');
    }
}

//check for guest
function checkGuest(req, res, next) {
    if (req.session.user) {
        res.redirect('/home');
    } else {
        next();
    }
}

//check username and password is not empty
function validateLoginInput(req, res, next) {
    const { username, password } = req.body;

    if (!username || !password) {
        return res.render('login', { msg: "Username and Password are required" });
    }

    next();
}

module.exports = { checkAuth, checkGuest, validateLoginInput };
